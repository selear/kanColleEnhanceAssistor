<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>装备改修助手</title>
    <style>
        .v-enter,
        .v-leave-to {
            opacity: 0;
            transform: translateY(-100%);
            transition: all 0.4s ease;
        }

        .v-enter-active,
        .v-leave-active {
            transition: all 0.25s ease;
        }
    </style>
</head>
<body>

<div id="app">
    <category-list :c-arr="CATEGORY"></category-list>
</div>

<template id="categoryList">
    <div>
        <h2>这是categoryList</h2>
        <category v-for="(entity, id) in cArr" :key="id"
                  :entity="entity[1]">
        </category>
    </div>
</template>

<template id="category">
    <div>
        <h3 @click="display=!display">{{ cName }} -- {{ equipIds.length }} </h3>
        <transition-group tag="ul">
            <equip v-for="id in equipIds"
                   v-show="display"
                   :key="id"
                   :id="id">
            </equip>
        </transition-group>
    </div>
</template>

<template id="equip">
    <li>{{ id }}</li>
</template>

<script src="lib/vue.js"></script>
<script src="lib/equips.js"></script>
<script>

  let comEquip = {
    template: '#equip',
    props: ['id'],
    computed: {}
  };

  let comCategory = {
    template: '#category',
    data() {
      return {
        display: false
      };
    },
    components: {
      equip: comEquip
    },
    props: ['entity'],
    computed: {
      cName: function () {
        return this.entity.name;
      },
      equipIds: function () {
        return this.entity.equipIds;
      }
    }
  };

  Vue.component('categoryList', {
    template: '#categoryList',
    components: {
      category: comCategory,
    },
    props: ['cArr']
  });

  let vm = new Vue({
    el: '#app',
    data: {
      CATEGORY: undefined,
      EQUIP: undefined,
      flag: 'is page loaded?'
    },
    mounted() {
      this.CATEGORY = new Map(JSON.parse(META[0]));
      this.EQUIP = new Map(JSON.parse(META[1]));
    }
  });

</script>
</body>
</html>